<nb-card class="shadow rounded" style="min-height: 84vh !important;">
  <nb-card-header>LncRNA Explorer</nb-card-header>
  <nb-card-body class="shadow rounded pt-1">
    <div class="card pb-4 mb-4" style="font-size: 14px !important;font-family: 'Exo 2';">
      <p-toast></p-toast>
      <p-table class="primeng-table" #dt [value]="genes" [rows]="itemPrePage" [paginator]="true"
               [rowHover]="true" dataKey="id" [lazy]="true" [loading]="loading"
               [rowsPerPageOptions]="rowsPerPageOptions" [totalRecords]="totalRecords"
               (onLazyLoad)="loadListing($event)"
               currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
               [showCurrentPageReport]="true" [resizableColumns]="true" columnResizeMode="expand"
               styleClass="p-datatable-gridlines">
        <ng-template pTemplate="caption">
          <!-- Updated search section to match AlphaGenome styling -->
          <div class="flex align-items-center justify-content-between row" style="width: 100% !important;">
            <div class="col-12 col-xl-4 col-lg-6 col-md-6 col-sm-12">
              <h5 class="m-0">Gene Details</h5>
            </div>

            <!-- Updated Search Input Section - Nebular styling -->
            <div class="col-12 col-xl-6 col-lg-6 col-md-6 col-sm-12">
              <div class="d-flex align-items-center">
              <nb-form-field class="flex-grow-1 me-2">
                <nb-icon nbPrefix icon="search-outline"></nb-icon>
                <input
                  nbInput
                  [(ngModel)]="search"
                  name="search"
                  type="text"
                  (keypress)="onKeyPress($event)"
                  placeholder="Enter gene name or ID..."
                  [disabled]="isLoading"
                  style="width: 100%;">
              </nb-form-field>

                <button
                  nbButton
                  status="primary"
                  size="medium"
                  (click)="onSearch()"
                  [disabled]="!search?.trim() || isLoading"
                  class="me-1">
                  <nb-icon icon="search-outline" *ngIf="!isLoading"></nb-icon>
                  <nb-spinner size="small" *ngIf="isLoading"></nb-spinner>
                  Search
                </button>

                <button
                  nbButton
                  status="basic"
                  outline
                  size="medium"
                  (click)="clearSearch(dt)"
                  *ngIf="search">
                  <nb-icon icon="close-outline"></nb-icon>
                </button>
              </div>
            </div>

            <div class="col-12 col-xl-2 col-lg-6 col-md-6 col-sm-12 p-0 text-right">
              <!-- Space for additional controls if needed -->
            </div>
          </div>
        </ng-template>
        <ng-template pTemplate="header">
          <tr>
            <th pResizableColumn pSortableColumn="cutar_id">
              <div class="flex justify-content-between align-items-center d-flex">
                cuTAR Id
                <p-sortIcon field="cutar_id"></p-sortIcon>
              </div>
            </th>
            <th pResizableColumn pSortableColumn="chromosome">
              <div class="flex justify-content-between align-items-center d-flex">
                Chromosome
                <p-sortIcon field="chromosome"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="start">
              <div class="flex justify-content-between align-items-center">
                Start
                <p-sortIcon field="start"></p-sortIcon>
              </div>
            </th>
            <th pResizableColumn pSortableColumn="end">
              <div class="flex justify-content-between align-items-center">
                End
                <p-sortIcon field="end"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="transcript">
              <div class="flex justify-content-between align-items-center">
                Transcript
                <p-sortIcon field="transcript"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="strand">
              <div class="flex justify-content-between align-items-center">
                Strand
                <p-sortIcon field="strand"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="samples_detected">
              <div class="flex justify-content-between align-items-center">
                Samples Detected
                <p-sortIcon field="samples_detected"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="cancer_types_detected">
              <div class="flex justify-content-between align-items-center">
                Cancer Types Detected
                <p-sortIcon field="cancer_types_detected"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="cell_type_specificity">
              <div class="flex justify-content-between align-items-center">
                Cell Type Specificity
                <p-sortIcon field="cell_type_specificity"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="cell_type_specificity_in_cancer_type">
              <div class="flex justify-content-between align-items-center">
                Cell Type Specificity In Cancer Type
                <p-sortIcon field="cell_type_specificity_in_cancer_type"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="detection_in_other_databases">
              <div class="flex justify-content-between align-items-center">
                Detection In Other Databases
                <p-sortIcon field="detection_in_other_databases"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="cell_type_specificity_in_cancer_type">
              <div class="flex justify-content-between align-items-center">
                Cell Type Specificity In Cancer Type
                <p-sortIcon field="cell_type_specificity_in_cancer_type"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="id_in_other_databases">
              <div class="flex justify-content-between align-items-center">
                Id In Other Databases
                <p-sortIcon field="id_in_other_databases"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="noncodeid">
              <div class="flex justify-content-between align-items-center">
                Non Codeied
                <p-sortIcon field="noncodeid"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="disease">
              <div class="flex justify-content-between align-items-center">
                Disease
                <p-sortIcon field="disease"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="gene">
              <div class="flex justify-content-between align-items-center">
                Gene
                <p-sortIcon field="gene"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="classification">
              <div class="flex justify-content-between align-items-center">
                Classification
                <p-sortIcon field="classification"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="overlapping_promoter">
              <div class="flex justify-content-between align-items-center">
                Overlapping Promoter
                <p-sortIcon field="overlapping_promoter"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="overlapping_enhancer">
              <div class="flex justify-content-between align-items-center">
                Overlapping Enhancer
                <p-sortIcon field="overlapping_enhancer"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="enhancer_associated">
              <div class="flex justify-content-between align-items-center">
                Enhancer Associated
                <p-sortIcon field="enhancer_associated"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="overlapping_snps">
              <div class="flex justify-content-between align-items-center">
                Overlapping SNPs
                <p-sortIcon field="overlapping_snps"></p-sortIcon>
              </div>

            </th>
            <th pResizableColumn pSortableColumn="overlapping_orf">
              <div class="flex justify-content-between align-items-center">
                Overlapping ORF
                <p-sortIcon field="overlapping_orf"></p-sortIcon>
              </div>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-product>
          <tr>
            <td>{{ product?.cutarId }}</td>
            <td>{{ product?.chromosome }}</td>
            <td>{{ product?.start }}</td>
            <td>{{ product?.end }}</td>
            <td>{{ product?.transcript }}</td>
            <td>{{ product?.strand }}</td>
            <td>{{ product?.samplesDetected }}</td>
            <td>{{ product?.cancerTypesDetected }}</td>
            <td>{{ product?.cellTypeSpecificity }}</td>
            <td>{{ product?.cellTypeSpecificityInCancerType }}</td>
            <td>{{ product?.detectionInOtherDatabases }}</td>
            <td>{{ product?.cellTypeSpecificityInCancerType }}</td>
            <td>{{ product?.idInOtherDatabases }}</td>
            <td>{{ product?.noncodeid }}</td>
            <td>{{ product?.disease }}</td>
            <td>{{ product?.gene }}</td>
            <td>{{ product?.classification }}</td>
            <td>{{ product?.overlappingPromoter }}</td>
            <td>{{ product?.overlappingEnhancer }}</td>
            <td>{{ product?.enhancerAssociated }}</td>
            <td>{{ product?.overlappingSnps }}</td>
            <td>{{ product?.overlappingOrf }}</td>
          </tr>
        </ng-template>
        <ng-template pTemplate="summary">
          <div class="flex align-items-center justify-content-between">In total there are
            {{ genes ? genes.length : 0 }} products.
          </div>
        </ng-template>
      </p-table>
    </div>

    <p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>


  </nb-card-body>
</nb-card>
