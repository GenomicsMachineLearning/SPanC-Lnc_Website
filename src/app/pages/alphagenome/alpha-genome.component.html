<nb-card style="padding: 0 55px !important;">
  <nb-card-header>Search AlphaGenome</nb-card-header>
  <nb-card-body class="shadow rounded pt-1">
    <div class="card pb-4 mb-4" style="font-size: 14px !important;font-family: 'Exo 2';">
      <p-toast></p-toast>

      <div class="flex align-items-center justify-content-between row" style="width: 100% !important;">
        <div class="col-12 col-xl-4 col-lg-6 col-md-6 col-sm-12">
          <h5 class="m-0">Gene Details</h5>
        </div>
        <!-- Search Input Section -->
        <div class="col-12 col-xl-6 col-lg-6 col-md-6 col-sm-12">
          <div class="d-flex align-items-center">
            <nb-form-field class="flex-grow-1 me-2" [class.muted]="isLoading">
              <nb-icon nbPrefix icon="search-outline"></nb-icon>
              <input
                nbInput
                [(ngModel)]="search"
                name="search"
                type="text"
                (keypress)="onKeyPress($event)"
                placeholder="Enter gene name or ID..."
                [disabled]="isLoading"
                style="width: 100%;">
            </nb-form-field>

            <button
              nbButton
              status="primary"
              size="medium"
              (click)="onSearch()"
              [disabled]="!search?.trim() || isLoading"
              class="me-1">
              <nb-icon icon="search-outline" *ngIf="!isLoading"></nb-icon>
              Search
            </button>

            <button
              nbButton
              status="basic"
              outline
              size="medium"
              (click)="clearSearch()"
              [disabled]="isLoading"
              *ngIf="search || imageUrl">
              <nb-icon icon="close-outline"></nb-icon>
            </button>
          </div>
        </div>

        <div class="col-12 col-xl-2 col-lg-6 col-md-6 col-sm-12 p-0 text-right">
        </div>
      </div>

      <!-- Error Message -->
      <div class="mt-3" *ngIf="errorMessage">
        <nb-alert status="danger">
          <strong>Error:</strong> {{errorMessage}}
        </nb-alert>
      </div>

      <!-- Loading Indicator -->
      <div class="mt-3 text-center" *ngIf="isLoading">
        <nb-spinner size="large"></nb-spinner>
      </div>

      <!-- Search Results - Image Display -->
      <div class="mt-4" *ngIf="(searchResults || imageUrl) && !isLoading">
        <nb-card>
          <nb-card-header>
            <h6 class="mb-0">Search Results for: <strong>{{currentSearchTerm}}</strong></h6>
          </nb-card-header>
          <nb-card-body class="text-center">
            <img
              [src]="imageUrl"
              [alt]="'Gene visualization for ' + search"
              class="img-fluid rounded shadow"
              style="max-width: 100%; max-height: 500px;"
              (error)="errorMessage = 'Failed to load image'"
              (load)="errorMessage = ''">
          </nb-card-body>
        </nb-card>
      </div>

      <!-- No Results Message -->
      <div class="mt-3 text-center" *ngIf="searchResults && !imageUrl && !isLoading && currentSearchTerm">
        <nb-alert status="warning">
          No image data found for "{{currentSearchTerm}}".
        </nb-alert>
      </div>
    </div>
  </nb-card-body>
</nb-card>
